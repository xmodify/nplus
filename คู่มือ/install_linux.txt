################## Almalinux 9.4 ###################
1.เตรียมระบบพื้นฐาน (ถ้ายังไม่ได้ลง)
	sudo dnf update -y
	sudo dnf install -y git unzip

2.ติดตั้ง Apache + PHP (Laravel แนะนำ PHP ≥ 8.1)
	sudo dnf install -y epel-release
	sudo dnf install -y https://rpms.remirepo.net/enterprise/remi-release-9.rpm
	sudo dnf module enable -y php:remi-8.1
	sudo dnf install -y php php-cli php-common php-mbstring php-xml php-bcmath php-curl php-zip php-mysqlnd php-pdo php-tokenizer php-opcache unzip git curl

3.ติดตั้ง Composer
	cd /tmp
	php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
	php composer-setup.php
	sudo mv composer.phar /usr/local/bin/composer
	composer --version

4.Clone Project ลง /var/www/html/rims
	cd /var/www/html
	sudo git clone https://github.com/xmodify/nplus.git

5.ตั้ง permission ให้ Apache ใช้งานได้
	sudo chown -R apache:apache /var/www/html/nplus
	sudo chmod -R 775 /var/www/html/nplus
	sudo chmod -R 775 /var/www/html/nplus/storage
	sudo chmod -R 775 /var/www/html/nplus/bootstrap/cache

6.ติดตั้ง Laravel dependencies
	cd /var/www/html/nplus
	sudo -u apache /usr/local/bin/composer install

7.ตั้งค่าไฟล์ .env
	sudo -u apache cp .env.example .env
	sudo -u apache php artisan key:generate
	sudo nano .env

8.git pull ผ่าน User
	sudo -u apache git -C /var/www/html/nplus reset --hard
	sudo -u apache git -C /var/www/html/nplus pull origin main
	sudo -u apache /usr/local/bin/composer install --no-dev --optimize-autoloader
	sudo -u apache rm -f /var/www/html/nplus/bootstrap/cache/*.php
	sudo -u apache php artisan optimize:clear
	
9.ตั้งค่า Apache หรือ Nginx ให้ชี้มาที่ public/
	sudo dnf install -y httpd
	sudo systemctl enable httpd
	sudo systemctl start httpd

10.Node.js Setup:
	sudo dnf module reset nodejs -y
	sudo dnf module enable nodejs:20 -y
	sudo dnf install -y nodejs
	cd /var/www/html/rims
	sudo -u apache npm install
	sudo -u apache npm run build

###########################################################
# 11. การตั้งค่าแบบ Option B (แนะนำ - เลียนแบบ /gtw/)
###########################################################

1. แก้ไขไฟล์ VirtualHost ของพอร์ต 8883 (เช่น /etc/httpd/conf.d/laravel.conf):
   Listen 8883
   <VirtualHost *:8883>
       ServerName 192.168.0.4
       Alias /rims "/var/www/html/nplus/public"
       DocumentRoot "/var/www/html/nplus/public"
       <Directory "/var/www/html/nplus/public">
           Options FollowSymLinks
           AllowOverride All
           Require all granted
           FallbackResource /rims/index.php
       </Directory>
   </VirtualHost>

2. แก้ไขไฟล์ Proxy (พอร์ต 80) ในไฟล์ config หลักของ Apache:
   <VirtualHost *:80>
       ServerName 192.168.0.4

       # แก้ไขปัญหา 404 ด้วย Location Block (ชัวร์กว่าเดิม)
       <Location /rims>
           ProxyPass http://127.0.0.1:8883/nplus
           ProxyPassReverse http://127.0.0.1:8883/nplus
       </Location>
       
       ProxyPassReverseCookiePath /nplus /nplus
   </VirtualHost>

3. คำสั่งสำคัญ เพื่อไม่ให้ติด 404 (SELinux และ Firewall):
   sudo setsebool -P httpd_can_network_connect 1
   sudo semanage port -a -t http_port_t -p tcp 8883
   sudo firewall-cmd --permanent --add-port=8883/tcp
   sudo firewall-cmd --reload

4. ตั้งค่าใน .env:
   APP_URL=http://192.168.0.4/nplus

5. รีสตาร์ท Apache:
   sudo systemctl restart httpd


/public/.htaccess
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^ index.php [L]
</IfModule>

